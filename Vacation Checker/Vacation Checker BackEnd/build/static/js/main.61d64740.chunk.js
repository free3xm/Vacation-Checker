(this["webpackJsonpvacation-checker"]=this["webpackJsonpvacation-checker"]||[]).push([[0],[,,,,,function(e,t,a){e.exports={userWrapper:"User_userWrapper__742np",userHeader:"User_userHeader__dQZ8X",userMain:"User_userMain__3TnwI",listVacationsWrapper:"User_listVacationsWrapper__19r_C",listVacationsHeader:"User_listVacationsHeader__2lwxE",vacationsInfoWrapper:"User_vacationsInfoWrapper__SWSF5",filter:"User_filter__132TK",listVacations:"User_listVacations__1ErDt",UserWrapper:"User_UserWrapper__37p_g"}},,,,,,,,function(e,t,a){e.exports={bg:"App_bg__3E2O1",header:"App_header__HJe9c",logoWrapper:"App_logoWrapper__PZTSS",logo:"App_logo__3c5Aq",links:"App_links__1420P"}},,function(e,t,a){e.exports={main:"Login_main__1rpw2",form:"Login_form__28rcw",btnLogin:"Login_btnLogin__1zArv",checkboxWrapper:"Login_checkboxWrapper__2k4Gd",forgotPass:"Login_forgotPass__3l-kN"}},function(e,t,a){e.exports={vacation:"UserVacations_vacation__3aHHd",description:"UserVacations_description__axQhE",btnWrapper:"UserVacations_btnWrapper__2YzA8",btnVacation:"UserVacations_btnVacation__2RYg_"}},,function(e,t,a){e.exports={userInfo:"UserInfo_userInfo__4Pcio",userInfoTitle:"UserInfo_userInfoTitle__1uL3a",userInfoItems:"UserInfo_userInfoItems__Ij0px",btnAddVacation:"UserInfo_btnAddVacation__23IOj"}},function(e,t,a){e.exports={main:"AddVaction_main__AONfz",btnSubmitVac:"AddVaction_btnSubmitVac__2L2W4",btnClose:"AddVaction_btnClose__1ifRb",description:"AddVaction_description__2wSm_"}},function(e,t,a){e.exports={modalWrapper:"EditVacation_modalWrapper__CxhPE",modal:"EditVacation_modal__LT23y",description:"EditVacation_description__3ubuv"}},function(e,t,a){e.exports={modalWrapper:"DeleteVacation_modalWrapper__2dEzH",modal:"DeleteVacation_modal__1NaKY",btnWrapper:"DeleteVacation_btnWrapper__753hN"}},function(e,t,a){e.exports={main:"SignUp_main__33f0u",form:"SignUp_form__1MdVU",btnLogin:"SignUp_btnLogin__3zx0W"}},,,,function(e,t,a){e.exports={err:"VacationError_err__2aUwZ",btnErr:"VacationError_btnErr__5jBdw"}},,,,,,function(e,t,a){e.exports={err:"Err404_err__3h25b"}},function(e,t,a){e.exports=a(44)},,,,,,,,,,function(e,t,a){},function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(29),i=a.n(s),o=a(11),l=a(6),c=a(7),u=a(9),d=a(8),m=a(10),p=a(12),h=a(15),f=a.n(h),v=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(u.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(r)))).state={err:null},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"checkUser",value:function(e){var t=this;e.preventDefault();var a=e.target.login.value,n=e.target.password.value,r=e.target.remeber.checked;fetch(this.props.url,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({login:a.toLowerCase(),pass:n})}).then((function(e){if(200!==e.status)throw Error("user not found");return e.json()})).then((function(e){return t.props.login(e,r)})).catch((function(e){return t.setState({err:e.message})}))}},{key:"render",value:function(){return r.a.createElement("div",{className:f.a.main},r.a.createElement("form",{className:f.a.form,onSubmit:this.checkUser.bind(this)},r.a.createElement("input",{type:"text",placeholder:"username",name:"login"}),r.a.createElement("input",{type:"password",placeholder:"password",name:"password"}),r.a.createElement("div",{className:f.a.checkboxWrapper},r.a.createElement("label",{htmlFor:"remeberMe"},"Remeber Me"),r.a.createElement("input",{type:"checkbox",name:"remeber",id:"remeberMe"})),r.a.createElement(o.b,{className:f.a.forgotPass,to:"/"},"Forgot password"),r.a.createElement("button",{type:"submit",className:f.a.btnLogin},"Sign In"),this.state.err?r.a.createElement("span",null,this.state.err):r.a.createElement("span",null)))}}]),t}(r.a.Component),E=a(5),b=a.n(E),_=a(16),g=a.n(_),y=function(e){return r.a.createElement("li",{className:g.a.vacation},r.a.createElement("p",null,e.index+1),r.a.createElement("p",null,e.startDate),r.a.createElement("p",null,e.endDate),r.a.createElement("p",{className:g.a.description},e.description),r.a.createElement("div",{className:g.a.btnWrapper},r.a.createElement("button",{className:g.a.btnVacation,onClick:e.editHandler},"Edit"),r.a.createElement("button",{className:g.a.btnVacation,onClick:e.deleteHandler},"Delete")))},D=a(18),k=a.n(D),S=function(e){return r.a.createElement("div",{className:k.a.userInfo},r.a.createElement("h2",{className:k.a.userInfoTitle},"User Information"),r.a.createElement("div",{className:k.a.userInfoItems},r.a.createElement("p",null,"Email: ",e.email),r.a.createElement("p",null,"Employment date:  ",e.date),r.a.createElement("p",null,"Available vacation days: ",e.days," "),r.a.createElement("button",{className:k.a.btnAddVacation,onClick:e.showAddVac},"Add Vaction")))},w=a(19),V=a.n(w),N=function(e){return r.a.createElement("div",{className:V.a.main},r.a.createElement("form",{onSubmit:e.subVac,onChange:e.addDate},r.a.createElement("h2",null,"Add vacation"),r.a.createElement("button",{className:V.a.btnClose,onClick:e.closeAddVac},"X"),r.a.createElement("div",null,r.a.createElement("label",{htmlFor:"startDate"},"Vacation start date"),r.a.createElement("input",{type:"date",name:"startDate"})),r.a.createElement("div",null,r.a.createElement("label",{htmlFor:"endDate"},"Vacation end date"),r.a.createElement("input",{type:"date",name:"endDate"})),r.a.createElement("div",null,r.a.createElement("label",{htmlFor:"description"},"Description"),r.a.createElement("textarea",{name:"description",className:V.a.description})),r.a.createElement("button",{type:"submit",disabled:!e.valid,className:V.a.btnSubmitVac},"Add")))},O=a(26),j=a.n(O),A=function(e){return r.a.createElement("div",{className:j.a.err},r.a.createElement("img",{src:"./info.svg"}),r.a.createElement("p",null,e.err),r.a.createElement("button",{className:j.a.btnErr,onClick:e.closeErr},"OK"))},x=a(20),U=a.n(x),W=function(e){return r.a.createElement("div",{className:U.a.modalWrapper},r.a.createElement("form",{className:U.a.modal,onChange:e.change,onSubmit:e.editSubmit},r.a.createElement("label",{htmlFor:"startDate"},"Vacation start date"),r.a.createElement("input",{type:"date",name:"startDate",value:e.vac.startDate}),r.a.createElement("label",{htmlFor:"endDate"},"Vacation end date"),r.a.createElement("input",{type:"date",name:"endDate",value:e.vac.endDate}),r.a.createElement("label",{htmlFor:"description"},"Description"),r.a.createElement("textarea",{className:U.a.description,name:"description",value:e.vac.description}),r.a.createElement("button",{type:"submit",disabled:!e.valid},"Save"),r.a.createElement("button",{onClick:e.close},"Cancel")))},C=a(21),I=a.n(C),L=function(e){return r.a.createElement("div",{className:I.a.modalWrapper},r.a.createElement("form",{onSubmit:e.subDelete,className:I.a.modal},r.a.createElement("h2",null,"Delete this vacation?"),r.a.createElement("div",{className:I.a.btnWrapper},r.a.createElement("button",{type:"Submit"},"OK"),r.a.createElement("button",{onClick:e.close},"Cancel"))))},H={url:"http://localhost:3001"},T=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(u.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(r)))).state={daysFromHiring:Math.floor((new Date-new Date(a.props.user.date))/2592000000.0000005*1.75),vacation:{startDate:"",endDate:"",days:0,description:""},valid:!1,add:{show:!1},edit:{show:!1,index:null,err:null,valid:!0},delete:{index:null,show:!1},err:null,filterOption:"",user:a.props.user},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.updateDays()}},{key:"getWorkingDays",value:function(e,t){for(var a=0;e<=t;)0!==e.getDay()&&6!==e.getDay()&&a++,e.setDate(e.getDate()+1);return a}},{key:"updateAll",value:function(e,t){this.props.updateUser(t),this.updateDays();var a=this.state;a[e].show=!1,a.user=this.props.user,this.setState((function(){return a}))}},{key:"updateDays",value:function(){var e=this,t=this.props.user.vacations.reduce((function(e,t){return e+t.days}),0);this.setState((function(){return{daysOfVacation:e.state.daysFromHiring-t}}))}},{key:"checkDate",value:function(e){var t=this.state.vacation;if(t[e.target.name]=e.target.value,this.setState((function(){return{vacation:t}})),""!==(t=this.state.vacation).startDate&&""!==t.endDate){var a=new Date(t.startDate),n=new Date(t.endDate);if(a<=n)if(a>new Date(this.state.user.date)){var r=this.getWorkingDays(a,n);if(r<=this.state.daysOfVacation){var s=this.state;s.valid=!0,s.err=null,s.vacation.days=r,this.setState((function(){return s}))}else this.setState((function(){return{err:"The number of working days may not exceed the number of vacation days.",valid:!1}}))}else this.setState((function(){return{err:"The start date of vacation cannot be less than the employment date",valid:!1}}));else this.setState((function(){return{valid:!1,err:"The end date cannot be less than the starting date of the vacation."}}))}}},{key:"showAddVacavtion",value:function(){var e=this.state;e.add.show=!0,this.setState((function(){return{state:e}}))}},{key:"submitVacation",value:function(e){var t=this;e.preventDefault(),this.state.valid&&fetch(H.url+"/addvacation",{method:"PUT",headers:{"Content-Type":"application/json","auth-token":this.props.token},body:JSON.stringify({vacation:this.state.vacation})}).then((function(e){return e.json()})).then((function(e){return t.updateAll("add",e)})).catch((function(e){return t.setState((function(){return{err:e}}))}))}},{key:"vacationHandler",value:function(e,t,a){var n=this.state;for(var r in n[t].show=!0,n[t].index=e,n.user.vacations[e])n.vacation[r]=n.user.vacations[e][r];this.setState((function(){return n}))}},{key:"editVacationHandler",value:function(e){var t=this.state;t.vacation[e.target.name]=e.target.value,this.setState((function(){return t})),t=this.state;var a=new Date(t.vacation.startDate),n=new Date(t.vacation.endDate);if(""!==t.vacation.startDate&&""!==t.vacation.endDate&&a<=n){var r=this.getWorkingDays(a,n);this.state.daysOfVacation+t.user.vacations[this.state.edit.index].days>=r?(t.edit.valid=!0,t.vacation.days=r,this.setState((function(){return t}))):(t.edit.valid=!1,this.setState((function(){return t})))}else t.edit.valid=!1,this.setState((function(){return t}))}},{key:"editVacSubmit",value:function(e){var t=this;this.state.edit.valid&&(e.preventDefault(),fetch(H.url+"/edit",{method:"PUT",headers:{"Content-Type":"application/json","auth-token":this.props.token},body:JSON.stringify({vacation:this.state.vacation,index:this.state.edit.index})}).then((function(e){return e.json()})).then((function(e){return t.updateAll("edit",e)})).catch((function(e){return t.setState((function(){return{err:e}}))})))}},{key:"submitDelete",value:function(e){var t=this;e.preventDefault(),fetch(H.url+"/deletevaction",{method:"DELETE",headers:{"Content-Type":"application/json","auth-token":this.props.token},body:JSON.stringify({index:this.state.delete.index})}).then((function(e){return e.json()})).then((function(e){return t.updateAll("delete",e)})).catch((function(e){return t.setState((function(){return{err:e}}))}))}},{key:"closeBtn",value:function(){var e=this.state;e.add.show=!1,e.vacation.startDate="",e.vacation.endDate="",e.vacation.description="",e.err=null,e.valid=!1,e.edit.show=!1,e.edit.valid=!0,e.delete.show=!1,this.setState((function(){return e}))}},{key:"filterHandler",value:function(e){var t=e.target.value;"all"!==t?this.setState((function(){return{filterOption:t}})):this.setState((function(){return{filterOption:""}}))}},{key:"closeErr",value:function(){this.setState((function(){return{err:null}}))}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:b.a.userWrapper},this.state.edit.show?r.a.createElement(W,{vac:this.state.vacation,change:this.editVacationHandler.bind(this),editSubmit:this.editVacSubmit.bind(this),valid:this.state.edit.valid,close:this.closeBtn.bind(this)}):null,this.state.delete.show?r.a.createElement(L,{subDelete:this.submitDelete.bind(this),close:this.closeBtn.bind(this)}):null,r.a.createElement("div",{className:b.a.userHeader},r.a.createElement("span",null,"User: ",this.props.user.name[0].toUpperCase()+this.props.user.name.slice(1)),this.state.err&&this.state.add.show?r.a.createElement(A,{err:this.state.err,closeErr:this.closeErr.bind(this)}):null),r.a.createElement("div",{className:b.a.userMain},this.state.add.show?r.a.createElement(N,{addDate:this.checkDate.bind(this),valid:this.state.valid,closeAddVac:this.closeBtn.bind(this),subVac:this.submitVacation.bind(this),err:this.state.err}):r.a.createElement(S,{email:this.props.user.email,date:this.props.user.date,days:this.state.daysOfVacation,showAddVac:this.showAddVacavtion.bind(this)}),r.a.createElement("div",{className:b.a.listVacationsWrapper},r.a.createElement("div",{className:b.a.listVacationsHeader},r.a.createElement("ul",{className:b.a.vacationsInfoWrapper},r.a.createElement("li",null,"\u2116"),r.a.createElement("li",null,"Start date"),r.a.createElement("li",null,"End date"),r.a.createElement("li",null,"Description"),r.a.createElement("li",null,r.a.createElement("select",{onChange:this.filterHandler.bind(this),className:b.a.filter},r.a.createElement("option",{value:"all"},"All"),Array.from(new Set(this.state.user.vacations.map((function(e){return e.startDate.slice(0,4)})))).map((function(e,t){return r.a.createElement("option",{key:t,value:e},e)})))))),r.a.createElement("ul",{className:b.a.listVacations},this.props.user.vacations.map((function(t,a){return e.state.filterOption&&e.state.filterOption!==t.startDate.slice(0,4)?null:r.a.createElement(y,{key:a,index:a,startDate:t.startDate,endDate:t.endDate,description:t.description,editHandler:e.vacationHandler.bind(e,a,"edit"),deleteHandler:e.vacationHandler.bind(e,a,"delete")})}))))))}}]),t}(r.a.Component),P=a(22),F=a.n(P),z=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(u.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(r)))).state={user:{login:"",email:"",password:"",date:""},err:{loginErr:null,emailErr:null,passwordErr:null,dateErr:null},validation:!1},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"validation",value:function(e){var t=this.state,a=t.user,n=t.err;a[e.target.name]=e.target.value,a.login.match(/^[a-zA-Z][a-zA-Z0-9-_\.]{1,20}$/g)?n.loginErr=null:n.loginErr="Incorrect username",a.email.match(/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/g)?n.emailErr=null:n.emailErr="Incorrect email",a.password.match(/^(?=.*\d)(?=.*[a-zA-Z])(?!.*\s).*$/g)?n.passwordErr=null:n.passwordErr="Incorrect password",""===a.date||new Date(a.date)>new Date?n.dateErr="Incorrect date":n.dateErr=null,Object.values(n).every((function(e){return null===e}))?this.setState((function(){return{validation:!0}})):this.setState.validation&&this.setState((function(){return{validation:!1}})),this.setState((function(){return{user:a}}))}},{key:"signup",value:function(e){var t=this;e.preventDefault(),fetch(H.url+"/signup",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({login:this.state.user.login.toLowerCase(),email:this.state.user.email.toLowerCase(),pass:this.state.user.password,date:this.state.user.date})}).then((function(e){if(400===e.status)throw Error("username exsits");e.json()})).then((function(e){return t.props.history.push("/")})).catch((function(e){return console.log(e)}))}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:F.a.main},r.a.createElement("form",{className:F.a.form,onChange:function(t){return e.validation.call(e,t)},onSubmit:function(t){return e.signup(t)}},r.a.createElement("input",{type:"text",name:"login",placeholder:"username"}),this.state.err.loginErr?r.a.createElement("span",null,this.state.err.loginErr):r.a.createElement("span",null),r.a.createElement("input",{type:"text",name:"email",placeholder:"email"}),this.state.err.emailErr?r.a.createElement("span",null,this.state.err.emailErr):r.a.createElement("span",null),r.a.createElement("input",{type:"password",name:"password",placeholder:"password"}),this.state.err.passwordErr?r.a.createElement("span",null,this.state.err.passwordErr):r.a.createElement("span",null),r.a.createElement("label",null,"Employment date"),r.a.createElement("input",{type:"date",name:"date"}),this.state.err.dateErr?r.a.createElement("span",null,this.state.err.dateErr):r.a.createElement("span",null),r.a.createElement("button",{type:"submit",className:F.a.btnLogin,disabled:!this.state.validation},"Sign Up")))}}]),t}(r.a.Component),M=a(32),J=a.n(M),Z=function(){return r.a.createElement("h2",{className:J.a.err},"404 not found")},B=a(13),K=a.n(B),R=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(u.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(r)))).state={isLogged:!1,token:void 0,user:{}},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"login",value:function(e,t){this.setState((function(){return{isLogged:!0,token:e.token,user:e.user}})),t&&localStorage.setItem("tjwt",e.token),sessionStorage.setItem("tjwt",e.token)}},{key:"updateUser",value:function(e){this.setState((function(){return{user:e.user}}))}},{key:"logout",value:function(){this.setState((function(){return{isLogged:!1,token:void 0,user:{}}})),localStorage.clear(),sessionStorage.clear()}},{key:"componentDidMount",value:function(){var e=this,t=sessionStorage.getItem("tjwt")||localStorage.getItem("tjwt");!this.state.token&&t&&fetch(H.url+"/auth",{method:"GET",headers:{"Content-Type":"application/json","auth-token":t}}).then((function(e){if(200!==e.status)throw Error("user not found");return e.json()})).then((function(a){e.setState((function(){return{user:a.user,isLogged:!0,token:t}}))})).catch((function(e){return console.log(e)}))}},{key:"render",value:function(){var e=this;return console.log(Object({NODE_ENV:"production",PUBLIC_URL:"http://localhost:3001"})),r.a.createElement("div",{className:K.a.bg},r.a.createElement("header",{className:K.a.header},r.a.createElement("div",{className:K.a.logoWrapper},r.a.createElement("img",{className:K.a.logo,src:"./logo.svg",alt:"logo"})),r.a.createElement("div",null,r.a.createElement(o.b,{className:K.a.links,to:"/"},"Home"),this.state.isLogged?r.a.createElement(o.b,{className:K.a.links,onClick:this.logout.bind(this),to:"/"},"Logout"):r.a.createElement(o.b,{className:K.a.links,to:"/signup"},"Sign Up"))),r.a.createElement(p.c,null,r.a.createElement(p.a,{path:"/",exact:!0,render:function(){return e.state.isLogged?r.a.createElement(T,Object.assign({},e.state,{updateUser:e.updateUser.bind(e)})):r.a.createElement(v,{login:e.login.bind(e),url:H.url})}}),r.a.createElement(p.a,{path:"/signup",component:z}),r.a.createElement(p.a,{render:Z})))}}]),t}(r.a.Component),Y=(a(43),r.a.createElement(o.a,null,r.a.createElement(R,null)));i.a.render(Y,document.getElementById("root"))}],[[33,1,2]]]);
//# sourceMappingURL=main.61d64740.chunk.js.map